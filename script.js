// DOM 元素獲取
const startBtn = document.getElementById('start-btn');
const restartBtn = document.getElementById('restart-btn');
const welcomeScreen = document.getElementById('welcome-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionText = document.getElementById('question-text');
const answerButtons = document.getElementById('answer-buttons');
const progressText = document.getElementById('progress-text');

// 結果顯示元素
const pathwayName = document.getElementById('pathway-name');
const pathwayPhilosophy = document.getElementById('pathway-philosophy');
const pathwayProfile = document.getElementById('pathway-profile');

let currentQuestionIndex = 0;
let pathwayScores = {};

// 測驗問題數據庫 (完整15題版)
const questions = [
    {
        question: "在深夜的貝克蘭德街頭，你目睹了一場非凡者之間的短暫衝突。一方逃離後，在原地留下了一本神秘的筆記。你會？",
        answers: [
            { text: "立即拾起筆記並迅速離開，找個安全的地方研究其中的秘密。", scores: { '隱者': 3, '門': 2, '通識者': 1 } },
            { text: "保持距離，暗中觀察，等待官方非凡者前來處理，並記錄下他們的行為模式。", scores: { '觀眾': 3, '審訊官': 1, '倒吊人': 1 } },
            { text: "認為這是個陷阱，或是與己無關的麻煩，選擇直接忽略並繞道而行。", scores: { '巨人': 2, '大地母神': 1, '愚者': -1 } },
            { text: "走上前去，用腳尖輕輕翻開筆記，只想滿足瞬間的好奇心，看看裡面寫了什麼。", scores: { '錯誤': 2, '魔女': 1, '獵人': 1 } }
        ]
    },
    {
        question: "你所在的團隊接到一項任務，需要從一個戒備森嚴的貴族莊園中獲取一份機密文件。你的首選策略是？",
        answers: [
            { text: "策劃一場完美的潛入，利用莊園的防禦漏洞，像幽靈一樣進出，不留下一絲痕跡。", scores: { '門': 3, '錯誤': 2, '永暗之河': 2 } },
            { text: "創造混亂。在城市另一端引發一場不大不小的騷動，調開大部分守衛力量，然後趁虛而入。", scores: { '紅祭司': 3, '愚者': 2, '深淵': 1 } },
            { text: "利用社交手腕和偽裝，製造一個合理的身份混入莊園的晚宴，在眾目睽睽之下巧妙地竊取文件。", scores: { '愚者': 3, '觀眾': 2, '魔女': 1 } },
            { text: "進行詳盡的外部勘察與情報收集，制定多套應變計畫，確保無論發生何種意外，團隊都能全身而退。", scores: { '白塔': 3, '觀眾': 2, '審訊官': 1 } }
        ]
    },
    {
        question: "你發現了一種可以穩定帶來財富，但會讓使用者逐漸喪失情感的非凡儀式。你會？",
        answers: [
            { text: "堅決抵制並想辦法銷毀所有相關知識，認為這種力量違反了人性的基本法則。", scores: { '太陽': 3, '審訊官': 2, '巨人': 1 } },
            { text: "自己謹慎地使用，嚴格控制劑量和頻率，將其視為達成更高目標的必要工具。", scores: { '囚犯': 3, '倒吊人': 2, '隱者': 1 } },
            { text: "將這個儀式「改良」後，匿名傳播出去，觀察它對社會造成的影響，以此作為一項有趣的實驗。", scores: { '愚者': 2, '魔女': 2, '深淵': 2 } },
            { text: "利用這個秘密，去控制那些已經使用過儀式並身居高位的人，讓他們為你服務。", scores: { '錯誤': 3, '觀眾': 2, '暴君': 1 } }
        ]
    },
    {
        question: "面對一個看似無解的古老謎團，你的研究方法更傾向於？",
        answers: [
            { text: "泡在圖書館和檔案館裡，從浩如煙海的歷史文獻和被人遺忘的記錄中尋找蛛絲馬跡。", scores: { '隱者': 3, '白塔': 2, '死神': 1 } },
            { text: "透過占卜、靈視等神秘學手段，直接向未知的存在或命運本身尋求啟示。", scores: { '愚者': 2, '命運之輪': 2, '月亮': 1 } },
            { text: "建立一個邏輯模型，將所有已知碎片放入其中，透過嚴密的推理和假設來填補空白。", scores: { '觀眾': 3, '通識者': 2, '審訊官': 1 } },
            { text: "親自前往與謎團相關的古老遺蹟探險，相信直覺和現場的感受會引導你找到答案。", scores: { '門': 2, '獵人': 2, '紅祭司': 1 } }
        ]
    },
    {
        question: "當你獲得強大的力量後，你認為最理想的狀態是？",
        answers: [
            { text: "成為秩序的化身，制定並執行絕對公正的規則，讓世界在你的掌控下穩定運行。", scores: { '審訊官': 3, '暴君': 2, '白塔': 2 } },
            { text: "隱於幕後，像操縱木偶一樣影響世界的走向，享受那種不為人知的全能感。", scores: { '愚者': 3, '觀眾': 3, '永暗之河': 1 } },
            { text: "隨心所欲，不受任何束縛，體驗生命中的一切可能性，無論是好是壞。", scores: { '魔女': 3, '錯誤': 2, '深淵': 2 } },
            { text: "保護自己關心的人和社區，建立一個能讓他們安居樂業的庇護所。", scores: { '大地母神': 3, '巨人': 2, '太陽': 1 } }
        ]
    },
    {
        question: "在一次公開演講或辯論中，你最有可能扮演的角色是？",
        answers: [
            { text: "冷靜的分析者，用數據和邏輯指出對方言論中的每一個漏洞。", scores: { '白塔': 3, '通識者': 2, '審訊官': 1 } },
            { text: "富有魅力的煽動者，用激情和極具感染力的語言引導聽眾的情緒。", scores: { '紅祭司': 3, '太陽': 2, '暴君': 1 } },
            { text: "沉默的觀察者，在人群中洞悉每個人的真實想法和派系關係。", scores: { '觀眾': 4, '倒吊人': 1 } },
            { text: "意外的攪局者，在關鍵時刻提出一個離題但卻能顛覆整個討論前提的問題。", scores: { '愚者': 3, '錯誤': 2, '命運之輪': 1 } }
        ]
    },
    {
        question: "如果可以，你希望獲得以下哪種知識？",
        answers: [
            { text: "理解宇宙終極真理的物理學和數學定律。", scores: { '隱者': 3, '白塔': 2, '通識者': 2 } },
            { text: "看穿任何人謊言、洞悉其內心深處動機的心理學知識。", scores: { '觀眾': 4, '審訊官': 1 } },
            { text: "所有失落文明的歷史和其魔法系統的完整記錄。", scores: { '愚者': 2, '死神': 2, '隱者': 1 } },
            { text: "預知未來股市波動和所有賭局結果的概率學方法。", scores: { '命運之輪': 3, '錯誤': 2 } }
        ]
    },
    {
        question: "你偶然獲得了一件強大的封印物，但它會持續對周圍環境造成輕微的負面影響。你會？",
        answers: [
            { text: "將其上交給教會或官方組織，相信他們有更專業的方法來處理。", scores: { '審訊官': 2, '太陽': 2, '巨人': 1 } },
            { text: "嘗試自己研究和控制它，希望能將其轉化為自己的力量。", scores: { '隱者': 2, '通識者': 2, '囚犯': 2 } },
            { text: "將其藏在一個無人知曉的地方，確保它既不會傷害別人，也不會被他人奪走。", scores: { '永暗之河': 3, '倒吊人': 2, '死神': 1 } },
            { text: "把它當作一個燙手山芋，用巧妙的手段讓它「意外」地轉移到你的敵人手中。", scores: { '錯誤': 3, '愚者': 2, '魔女': 1 } }
        ]
    },
    {
        question: "你對「美」的定義更接近於？",
        answers: [
            { text: "宏偉的建築、精密的機械和對稱的幾何圖形所展現的秩序之美。", scores: { '審訊官': 2, '白塔': 2, '通識者': 2 } },
            { text: "稍縱即逝的巧合、命運的奇妙邂逅和不可預測的變化之美。", scores: { '命運之輪': 3, '愚者': 2 } },
            { text: "隱藏在悲劇、痛苦和毀滅中所展現出的那種深刻而強烈的情感之美。", scores: { '魔女': 3, '深淵': 2, '倒吊人': 1 } },
            { text: "大自然中生命的循環、萬物的生長與繁衍所體現的原始之美。", scores: { '大地母神': 3, '月亮': 2, '死神': 1 } }
        ]
    },
    {
        question: "一位你信任的朋友向你坦白，他為了復仇，準備策劃一場會傷及無辜的襲擊。你會？",
        answers: [
            { text: "試圖用言語和邏輯說服他放棄，向他分析此舉的利弊和道德後果。", scores: { '觀眾': 3, '太陽': 2, '大地母神': 1 } },
            { text: "暗中破壞他的計畫，同時不讓他發現是你在干預，以保護無辜者和你朋友的安全。", scores: { '愚者': 3, '永暗之河': 2, '倒吊人': 1 } },
            { text: "尊重他的選擇，但會在他行動時，盡自己所能將無辜者的傷亡降到最低。", scores: { '獵人': 2, '紅祭司': 1, '命運之輪': 1 } },
            { text: "直接將他制服並移交給官方，認為這是阻止更大悲劇發生的最有效方法。", scores: { '審訊官': 3, '暴君': 2, '巨人': 2 } }
        ]
    },
    {
        question: "你必須在一場無法避免的戰爭中選邊站。你會選擇加入哪一方？",
        answers: [
            { text: "擁有正統名義和嚴明軍紀，旨在恢復舊有秩序的王國軍。", scores: { '審訊官': 2, '巨人': 2, '暴君': 1 } },
            { text: "由魅力非凡的領袖帶領，承諾為所有人帶來自由與變革的革命軍。", scores: { '紅祭司': 3, '太陽': 2, '愚者': 1 } },
            { text: "科技最先進、戰術最靈活，但目標僅僅是自身利益的傭兵團。", scores: { '通識者': 3, '獵人': 2, '錯誤': 1 } },
            { text: "哪一方都不加入，而是利用戰爭的混亂，在暗中實現自己的圖謀。", scores: { '倒吊人': 3, '深淵': 2, '永暗之河': 1 } }
        ]
    },
    {
        question: "你認為「瘋狂」是什麼？",
        answers: [
            { text: "一種必須被收容和治癒的疾病，是秩序的對立面。", scores: { '審訊官': 2, '太陽': 2, '大地母神': 1 } },
            { text: "看見世界表象之下，常人無法理解的更深層真實。", scores: { '觀眾': 2, '隱者': 2, '月亮': 2 } },
            { text: "一種強大的武器，可以摧毀敵人，也可以吞噬自己。", scores: { '魔女': 2, '紅祭司': 2, '深淵': 1 } },
            { text: "宇宙的本質狀態，清醒和理智才是短暫的幻覺。", scores: { '愚者': 2, '倒吊人': 2, '囚犯': 1 } }
        ]
    },
    {
        question: "你更願意如何度過一個安靜的下午？",
        answers: [
            { text: "在花園裡修剪植物，或是在鄉間散步，感受自然的生命力。", scores: { '大地母神': 3, '月亮': 2, '太陽': 1 } },
            { text: "進行體能訓練，打磨自己的戰鬥技巧，保持巔峰狀態。", scores: { '獵人': 3, '巨人': 2, '紅祭司': 1 } },
            { text: "躲在密室中，進行一項無人知曉的神秘學實驗。", scores: { '隱者': 3, '死神': 2, '囚犯': 1 } },
            { text: "參加一場優雅的下午茶會，編織一張複雜的社交關係網。", scores: { '觀眾': 2, '魔女': 1, '暴君': 1 } }
        ]
    },
    {
        question: "一個古老的預言宣稱你將帶來毀滅。你的反應是？",
        answers: [
            { text: "接受它，並將其視為自己無可推卸的宿命，甚至主動去實現它。", scores: { '深淵': 3, '死神': 2, '命運之輪': 1 } },
            { text: "盡一切可能去對抗這個預言，證明命運可以被改變。", scores: { '太陽': 3, '巨人': 2, '獵人': 1 } },
            { text: "深入研究預言的來源和每一個細節，試圖從中找到漏洞或歧義。", scores: { '白塔': 3, '隱者': 2, '錯誤': 1 } },
            { text: "徹底無視它，相信自己的行動只由當下的意志決定，而非虛無縹緲的未來。", scores: { '暴君': 3, '紅祭司': 2, '門': 1 } }
        ]
    },
    {
        question: "你認為最可貴的品質是什麼？",
        answers: [
            { text: "為了信念和所愛之人，承受任何痛苦的堅韌。", scores: { '倒吊人': 3, '囚犯': 2, '巨人': 1 } },
            { text: "永不滿足的好奇心和對未知永不停歇的探索。", scores: { '門': 3, '隱者': 2, '通識者': 1 } },
            { text: "在任何情況下都能保持絕對理智和冷靜的頭腦。", scores: { '觀眾': 3, '白塔': 2, '死神': 1 } },
            { text: "能夠洞悉並利用規則，同時又不受其束縛的靈活性。", scores: { '錯誤': 3, '愚者': 2, '獵人': 1 } }
        ]
    }
];

// 途徑結果數據庫 (完整22種途徑檔案)
const pathwayData = {
    '愚者': { name: "愚者 (The Fool)", philosophy: "世界是一個巨大的舞台，歷史是可以被任意編排的劇本，而變化與欺騙是撬動現實的槓桿。愚者途徑的精髓在於「扮演」，他們是天生的演員、導演和騙子，相信一切皆可被「嫁接」，一切現實皆可被「愚弄」。他們在幕後操縱著命運的絲線，享受著將不可能變為可能的智力快感。", profile: "你是一個極富想像力和創造力的人，善於從混亂中看到機會。你可能不喜歡循規蹈矩，更偏愛用非傳統的、甚至是狡詐的手段來解決問題。你享受掌控資訊的感覺，並能巧妙地引導他人，讓他們在不知不覺中按照你的意願行事。你對歷史、神秘學和象徵符號有著濃厚的興趣，並相信表象之下必有更深層的真實。" },
    '門': { name: "門 (Door)", philosophy: "空間是自由的疆域，知識是探索的鑰匙。門途徑的核心是對空間的理解和應用。他們是天生的旅行者、探險家和魔術師。他們能夠穿梭於常人無法企及的領域，打開任何封鎖的門扉。對他們而言，物理的障礙和距離的限制都是可以被超越的幻象。", profile: "你是一個充滿好奇心、熱愛自由且不喜歡被束縛的人。你對未知的事物和神秘的現象有著強烈的探索慾。你可能不喜歡長時間待在同一個地方，享受旅行和冒險帶來的樂趣。你足智多謀，總能找到意想不到的方法來解決困難，尤其擅長「逃脫」困境。" },
    '錯誤': { name: "錯誤 (Error)", philosophy: "任何系統都存在漏洞，任何概念都可被竊取。錯誤途徑的非凡者是宇宙的駭客，他們尋找並利用規則的「Bug」，扭曲時間、空間和命運。他們相信，真正的力量不是創造，而是通過寄生和竊取來篡改現實，讓世界按照他們的意志出現「錯誤」。", profile: "你思維敏捷，極具反叛精神，善於發現他人忽略的捷徑和漏洞。你看待世界的方式與眾不同，總能從常規中發現不合邏輯之處。你可能有些玩世不恭，享受智力上的優越感，並認為規則本身就是一種限制，而你的天賦就是超越這些限制。" },
    '觀眾': { name: "觀眾 (Visionary)", philosophy: "旁觀者清。真正的力量來自於深刻的理解，而非粗暴的干涉。觀眾途徑的非凡者是天生的心理學家、觀察者和分析師。他們能在紛繁複雜的人際關係和社會現象中，精準地洞察到最核心的驅動力和最隱秘的動機。他們追求的是精神層面的全知，透過觀察和引導來達成目的。", profile: "你是一個內斂、冷靜且極具洞察力的人。你習慣於在人群中保持沉默，默默觀察周遭的一切。你對他人的情緒和心理狀態非常敏感，能夠輕易看穿謊言和偽裝。你做決定前總會進行周密的分析，不喜歡衝動行事。你可能不善於成為焦點，但你享受那種作為「幕後智者」的感覺。" },
    '太陽': { name: "太陽 (Sun)", philosophy: "光明驅散一切黑暗，信念帶來無窮力量。太陽途徑的非凡者是光與熱的化身，是天生的領袖和鼓舞者。他們堅信正義、勇氣和榮耀，並用自身的光芒去淨化邪惡、溫暖同伴。他們的力量源於純粹的信念和對光明的歌頌，是黑暗與墮落天生的敵人。", profile: "你是一個開朗、正直、充滿正能量的人。你樂於助人，有著強烈的集體榮譽感，並願意為了團隊的利益而戰。你厭惡陰謀和詭計，更喜歡光明正大的競爭。你的存在本身就能給周圍的人帶來希望和勇氣，是團隊中不可或缺的核心。" },
    '暴君': { name: "暴君 (Tyrant)", philosophy: "力量即真理。在狂暴的風暴和雷霆面前，一切計謀和規則都顯得蒼白無力。暴君途徑的非凡者崇尚最純粹、最直接的力量。他們是海洋的霸主，風暴的化身，用無可匹敵的威勢來征服一切。他們堅信，絕對的力量能帶來絕對的權威。", profile: "你是一個果斷、強勢且充滿自信的人。你喜歡用直接的方式解決問題，不屑於使用陰謀詭計。你有著強烈的領導慾和控制慾，希望他人能夠服從你的意志。在壓力之下，你不但不會退縮，反而會變得更加堅韌和富有攻擊性。你享受站在權力頂峰、俯瞰眾生的感覺。" },
    '白塔': { name: "白塔 (White Tower)", philosophy: "知識即壁壘，全知即全能。白塔途徑的非凡者是知識的守護者和規則的詮釋者。他們相信，通過掌握一切知識，可以構建出無懈可擊的防禦，並限制一切變化。他們的力量在於「定義」和「限制」，將世界萬物納入自己構建的知識體系中，從而實現掌控。", profile: "你是一個博學、嚴謹且注重邏輯的人。你對知識有著強烈的渴求，並喜歡將事物分門別類，建立清晰的體系。你做事有條不紊，善於制定長遠的計畫。你可能不喜歡意外和變化，認為一切都應該在可預測的軌道上運行。" },
    '倒吊人': { name: "倒吊人 (Hanged Man)", philosophy: "忍耐孕育力量，犧牲通往救贖。倒吊人途徑的非凡者是陰影中的苦修者，他們相信通過承受痛苦和自我犧牲，可以換來更深層次的力量和對墮落的理解。他們的力量源於對陰影和靈界生物的控制，以及通過獻祭換取神恩。", profile: "你是一個堅忍、內省且富有犧牲精神的人。你能夠為了長遠的目標而忍受當下的痛苦和孤獨。你對事物的看法可能比較悲觀，但這也讓你比別人更能理解人性的陰暗面。你相信，真正的強大並非來自外在，而是源於內心的堅韌和對信念的執著。" },
    '永暗之河': { name: "永暗之河 (Darkness)", philosophy: "黑暗是萬物的歸宿，隱秘是最終的守護。永暗之河途徑的非凡者是黑夜的寵兒，是秘密的化身。他們崇尚寂靜、隱匿和終結，相信在永恆的黑暗中，一切紛爭都將平息。他們的力量在於操控黑暗、隱藏身形和帶來永恆的沉眠。", profile: "你是一個神秘、沉靜且喜歡獨處的人。你不喜歡成為眾人矚目的焦點，更享受在暗中觀察和行動。你守口如瓶，是他人眼中最值得信賴的秘密保管者。你可能給人一種疏離感，但你的內心深處尋求著安寧與平靜。" },
    '死神': { name: "死神 (Death)", philosophy: "死亡是唯一的公平，終結是新生的序曲。死神途徑的非凡者是靈魂的引渡者，是生命循環的掌管者。他們並不邪惡，而是維持宇宙平衡的必要存在。他們的力量在於操控靈魂、帶來安息和理解死亡的本質，從而超越生死。", profile: "你是一個冷靜、客觀且對生命有著深刻思考的人。你看待事物超越了表面的喜悲，能從終結中看到新的開始。你做事公正無私，不受情感左右。你對靈魂、來世等終極問題充滿好奇，並試圖從中找到生命的意義。" },
    '巨人': { name: "巨人 (Twilight Giant)", philosophy: "守護是我的天職，榮耀存於黃昏之戰。巨人途徑的非凡者是天生的戰士和守護者。他們擁有無與倫比的勇氣和堅不可摧的防禦，是戰場上最可靠的屏障。他們的力量在於光明、秩序和純粹的物理力量，是混亂和黑暗的堅定對抗者。", profile: "你是一個忠誠、可靠且富有責任感的人。你天生具有保護他人的慾望，並願意為此付出一切。你重視榮譽和承諾，言出必行。你可能不善言辭，但你的行動總能給人帶來無比的安全感。" },
    '魔女': { name: "魔女 (Demoness)", philosophy: "痛苦、恐懼和絕望是世界上最深刻、最真實的情感，也是最強大的力量源泉。魔女途徑的非凡者是災難和痛苦的散播者。她們擅長利用人性的弱點，製造恐慌和瘟疫，從中汲取力量。對她們而言，美麗與致命往往是一體兩面，誘惑是通往毀滅的捷徑。", profile: "你可能是一個情感強烈、敢愛敢恨的人，對事物的感受比常人更為深刻。你懂得如何利用自身的魅力來達成目的，並且不畏懼使用一些會引起他人不適的手段。你可能對傳統的道德觀念持懷疑態度，認為在極端的環境下，生存和勝利才是最重要的。" },
    '紅祭司': { name: "紅祭司 (Red Priest)", philosophy: "戰爭是推動進步的熔爐，征服是實現理想的手段。紅祭司途徑的非凡者是天生的戰爭狂人和陰謀家。他們享受競爭和挑戰，善於挑起爭端並從中獲利。他們的力量在於火焰、鐵血和煽動人心的能力，相信只有通過不斷的鬥爭才能實現最終的和平。", profile: "你是一個充滿野心、好勝心極強的人。你熱愛競爭，享受勝利帶來的快感。你善於制定策略，並能為了達成目標而動員他人。你可能具有很強的領袖魅力，但也可能顯得富有攻擊性和侵略性。" },
    '隱者': { name: "隱者 (Hermit)", philosophy: "知識本身就是力量，宇宙的奧秘隱藏在符號、星辰和魔法的深處。隱者途徑的非凡者是純粹的學者和神秘學家。他們畢生追求對世界本質的理解，沉浸在知識的海洋中。他們的力量來自於對魔法和自然法則的深刻洞悉，能夠編織出複雜而強大的法術。", profile: "你是一個求知慾極強、熱愛思考和研究的人。你享受獨處，認為社交活動會浪費你寶貴的時間。你對哲學、科學或神秘學等高深領域有著濃厚的興趣。你可能不善言辭，但你的內心世界極為豐富。你相信，只要掌握了足夠的知識，就能解決任何問題。" },
    '通識者': { name: "通識者 (Paragon)", philosophy: "萬物皆可解構，萬物皆可融合。通識者途徑的非凡者是鍊金術士和發明家，他們追求將魔法與科技完美結合。他們的力量在於分析、解構和重組物質，創造出強大的鍊金物品和機械造物。他們相信，通過不斷的改良和創新，可以突破一切限制。", profile: "你是一個動手能力極強、富有創造力的工匠。你喜歡拆解事物，研究其內部原理，然後將其改進或創造出全新的東西。你注重效率和實用性，相信技術可以解決大部分問題。你可能對純理論不感興趣，更喜歡將知識應用於實踐。" },
    '命運之輪': { name: "命運之輪 (Wheel of Fortune)", philosophy: "命運是概率的遊戲，幸運是可以被操縱的變數。命運之輪途徑的非凡者是命運的賭徒，他們能夠撥動概率之弦，為自己帶來好運，為敵人帶來厄運。他們相信，雖然命運的洪流不可阻擋，但可以通過巧妙的干預，讓浪花朝著對自己有利的方向濺起。", profile: "你可能是一個樂觀主義者，也可能是一個宿命論者，但你總相信事情會有轉機。你對概率、巧合和運氣等概念非常感興趣。你做決定時可能依賴直覺和一時的衝動，享受那種未知結果帶來的刺激感。" },
    '月亮': { name: "月亮 (Moon)", philosophy: "生命如潮汐，在圓缺之間輪迴；精神如鏡像，在真實與瘋狂中搖擺。月亮途徑的非凡者是生命與精神的雙重探索者。他們的力量源於月光，能夠操控動植物的生命力，也能扭曲他人的精神，製造幻覺和瘋狂。他們在治癒與致死、清醒與癲狂的邊緣遊走。", profile: "你的情緒可能像月相一樣多變，時而溫柔，時而冷酷。你對生命和精神世界有著深刻的感受力，能夠體會到他人難以察覺的細微變化。你可能具有藝術家氣質，但也需要時刻警惕自己內心的陰暗面。" },
    '大地母神': { name: "大地母神 (Mother)", philosophy: "大地承載萬物，生命生生不息。大地母神途徑的非凡者是自然與生命的化身，是豐饒與治癒的源泉。他們的力量來自於大地，能夠促進萬物生長，治癒傷痛，並為盟友提供堅實的保護。他們是所有生命的母親，慈愛而又威嚴。", profile: "你是一個富有同情心、充滿愛心的人。你喜歡照顧他人，並從中獲得滿足感。你熱愛自然，對生命充滿敬畏。你是一個天生的和平主義者，不喜歡紛爭，總是希望能為周圍的人帶來溫暖和安寧。" },
    '囚犯': { name: "囚犯 (Chained)", philosophy: "萬物皆被束縛，慾望即是枷鎖。囚犯途徑的非凡者深刻理解「束縛」這一概念。他們通過給自己施加各種限制和詛咒，換取扭曲而強大的力量。他們既是規則的囚徒，也是利用規則的大師，能夠為敵人戴上無形的鐐銬。", profile: "你可能是一個自律到近乎自虐的人，也可能是一個深刻理解規則並善於利用規則的人。你對人性中的慾望和弱點有著清醒的認識。你做事極有耐心，能夠為了最終的目標承受漫長的蟄伏和準備。" },
    '深淵': { name: "深淵 (Abyss)", philosophy: "墮落是回歸本性，慾望是宇宙的第一驅動力。深淵途徑的非凡者是混亂與腐化的使者。他們引誘智慧生命墮落，釋放其內心最原始的慾望，並從中汲取力量。他們相信，秩序和道德只是虛偽的表象，混亂和慾望才是宇宙的真實。", profile: "你是一個極度現實、洞悉人性黑暗面的人。你可能不相信任何崇高的理念，認為所有行為的背後都是自私的慾望在驅動。你具有極強的誘惑力和說服力，能夠輕易地挑動他人的情緒和慾望。" },
    '審訊官': { name: "審訊官 (Justiciar)", philosophy: "秩序是文明的基石，規則是維護秩序的唯一工具。審訊官途徑的非凡者是法律和秩序的堅定捍衛者。他們相信，一個穩定、可預測的社會，需要一套嚴格且不容挑戰的規則體系。他們的力量來自於「宣告」和「禁止」，將抽象的規則具現化為不可違逆的現實。", profile: "你是一個有條理、有原則且追求公平正義的人。你相信凡事都應有規矩，並對破壞規則的行為深惡痛絕。你做事嚴謹，注重細節和流程，有著強烈的責任感。你可能顯得有些刻板或不近人情，但你的內心深處懷揣著建立一個更美好、更有序世界的理想。" },
    '獵人': { name: "獵人 (Hunter)", philosophy: "生存就是一場狩獵，要麼成為獵人，要麼成為獵物。獵人途徑的非凡者是天生的掠食者和戰鬥專家。他們擅長追蹤、設置陷阱和利用環境，並能操控火焰進行戰鬥。他們信奉弱肉強食的叢林法則，並通過不斷的戰鬥和挑釁來證明自己的強大。", profile: "你是一個充滿活力、行動力極強的人。你喜歡挑戰和冒險，無法忍受平淡的生活。你反應迅速，善於在壓力下做出決斷。你可能有些衝動和好鬥，但你的直率和勇氣也讓你成為一個值得信賴的夥伴。" }
};

// 初始化所有可能的途徑分數
function initializeScores() {
    pathwayScores = {};
    for (const key in pathwayData) {
        pathwayScores[key] = 0;
    }
}

// 開始測驗
function startQuiz() {
    currentQuestionIndex = 0;
    initializeScores();
    welcomeScreen.classList.add('hidden');
    resultScreen.classList.add('hidden');
    quizScreen.classList.remove('hidden');
    showQuestion();
}

// 顯示問題
function showQuestion() {
    resetState();
    const question = questions[currentQuestionIndex];
    questionText.innerText = question.question;
    progressText.innerText = `問題 ${currentQuestionIndex + 1} / ${questions.length}`;

    question.answers.forEach(answer => {
        const button = document.createElement('button');
        button.innerText = answer.text;
        button.classList.add('btn');
        button.addEventListener('click', () => selectAnswer(answer));
        answerButtons.appendChild(button);
    });
}

// 清理上一題的按鈕
function resetState() {
    while (answerButtons.firstChild) {
        answerButtons.removeChild(answerButtons.firstChild);
    }
}

// 選擇答案並計分
function selectAnswer(answer) {
    for (const pathway in answer.scores) {
        if (pathwayScores.hasOwnProperty(pathway)) {
            pathwayScores[pathway] += answer.scores[pathway];
        }
    }

    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) {
        showQuestion();
    } else {
        showResult();
    }
}

// 顯示最終結果
function showResult() {
    quizScreen.classList.add('hidden');
    resultScreen.classList.remove('hidden');

    // 找出得分最高的途徑
    let maxScore = -Infinity;
    let resultPathway = '';
    for (const pathway in pathwayScores) {
        if (pathwayScores[pathway] > maxScore) {
            maxScore = pathwayScores[pathway];
            resultPathway = pathway;
        }
    }
    
    // 如果沒有任何分數（理論上不可能），則給一個預設結果
    if (!resultPathway ||!pathwayData[resultPathway]) {
        resultPathway = '愚者'; 
    }

    const data = pathwayData[resultPathway];
    pathwayName.innerText = data.name;
    pathwayPhilosophy.innerText = data.philosophy;
    pathwayProfile.innerText = data.profile;
}

// 事件監聽
startBtn.addEventListener('click', startQuiz);
restartBtn.addEventListener('click', startQuiz);